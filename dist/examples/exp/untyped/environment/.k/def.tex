\nonstopmode
\documentclass{article}
\usepackage[poster,style=bubble]{k}
\title{EXP-UNTYPED-ENVIRONMENT}
\begin{document}
\begin{kdefinition}
\maketitle
\begin{module}{\moduleName{EXP-UNTYPED-ENVIRONMENT-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{Exp}}}\syntax{({\nonTerminal{\sort{Exp}}})}{}\syntaxCont{\terminal{if}{{\nonTerminal{\sort{Exp}}}}\terminal{then}{{\nonTerminal{\sort{Exp}}}}\terminal{else}{{\nonTerminal{\sort{Exp}}}}}{strict(1)}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\mathrel{}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{\mu{{\nonTerminal{\sort{Id}}}}.{{\nonTerminal{\sort{Exp}}}}}{}\syntaxCont{\lambda{{\nonTerminal{\sort{Id}}}}.{{\nonTerminal{\sort{Exp}}}}}{}\syntaxCont{\terminal{let}{{\nonTerminal{\sort{Id}}}}\terminal{=}{{\nonTerminal{\sort{Exp}}}}\terminal{in}{{\nonTerminal{\sort{Exp}}}}}{}\syntaxCont{\terminal{letrec}{{\nonTerminal{\sort{Id}}}}\mathrel{}{{\nonTerminal{\sort{Id}}}}\terminal{=}{{\nonTerminal{\sort{Exp}}}}\terminal{in}{{\nonTerminal{\sort{Exp}}}}}{}\syntaxCont{{\nonTerminal{\sort{Int}}}}{}\syntaxCont{{\nonTerminal{\sort{Bool}}}}{}\syntaxCont{{\nonTerminal{\sort{Id}}}}{}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\terminal{+}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\terminal{-}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\terminal{*}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\terminal{/}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\terminal{\%}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{\terminal{-}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\terminal{<}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\terminal{<=}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\terminal{>}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\terminal{>=}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\terminal{==}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\terminal{!=}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\terminal{and}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{Exp}}}}\terminal{or}{{\nonTerminal{\sort{Exp}}}}}{strict}\syntaxCont{\terminal{not}{{\nonTerminal{\sort{Exp}}}}}{strict}
\end{syntaxBlock}
\krule{
\reduce{\terminal{let}{\variable[Id]{X}}\terminal{=}{\variable[Exp]{E}}\terminal{in}{\variable[Exp]{E'}}}{{\lambda{\variable[Id]{X}}.{\variable[Exp]{E'}}}\mathrel{}{\variable[Exp]{E}}}}{}{macro, anywhere}
\krule{
\reduce{\terminal{letrec}{\variable[Id]{F}}\mathrel{}{\variable[K]{X}}\terminal{=}{\variable[K]{E}}\terminal{in}{\variable[K]{E'}}}{\terminal{let}{\variable[Id]{F}}\terminal{=}{\mu{\variable[Id]{F}}.{\lambda{\variable[K]{X}}.{\variable[K]{E}}}}\terminal{in}{\variable[K]{E'}}}}{}{macro, anywhere}
\end{module}
\begin{module}{\moduleName{EXP-UNTYPED-ENVIRONMENT}}

\begin{syntaxBlock}{\nonTerminal{\sort{Val}}}\syntax{{\nonTerminal{\sort{Int}}}}{}\syntaxCont{{\nonTerminal{\sort{Bool}}}}{}
\end{syntaxBlock}

\begin{syntaxBlock}{\nonTerminal{\sort{Exp}}}\syntax{{\nonTerminal{\sort{Val}}}}{}
\end{syntaxBlock}

\begin{syntaxBlock}{\nonTerminal{\sort{KResult}}}\syntax{{\nonTerminal{\sort{Val}}}}{}
\end{syntaxBlock}
\kconfig{\kall[yellow]{T}{\kall[green]{k}{\variable[Exp]{\$PGM}}
\mathrel{}\kall[LightSkyBlue]{env}{\dotCt{Map}}
\mathrel{}\kall[white]{store}{\dotCt{Map}}
\mathrel{}\kall[gray]{nextLoc}{\constant[\#Int]{0}}
}
\mathrel{}\kall{result}{\dotCt{K}}
}
\krule{
\reduce{\kmiddle[yellow]{T}{\kall[green]{k}{\variable[Val]{V}}
}
}{\kall{result}{\variable[Val]{V}}
}}{}{}
\krule{
\kprefix[green]{k}{\reduce{\variable[Id]{X}}{\variable[Exp]{E}}}
\mathrel{}\kmiddle[LightSkyBlue]{env}{\variable[Id]{X}\mapsto\variable[Nat]{L}}
\mathrel{}\kmiddle[white]{store}{\variable[Nat]{L}\mapsto\variable[Exp]{E}}
}{}{}
\krule{
\reduce{{\variable[Int]{I1}}\terminal{+}{\variable[Int]{I2}}}{{\variable[Int]{I1}}\mathrel{+_{\scriptstyle\it Int}}{\variable[Int]{I2}}}}{}{}
\krule{
\reduce{{\variable[Int]{I1}}\terminal{-}{\variable[Int]{I2}}}{{\variable[Int]{I1}}\mathrel{-_{\scriptstyle\it Int}}{\variable[Int]{I2}}}}{}{}
\krule{
\reduce{{\variable[Int]{I1}}\terminal{*}{\variable[Int]{I2}}}{{\variable[Int]{I1}}\mathrel{\ast_{\scriptstyle\it Int}}{\variable[Int]{I2}}}}{}{}
\krule{
\reduce{{\variable[Int]{I1}}\terminal{/}{\variable[Int]{I2}}}{{\variable[Int]{I1}}\mathrel{\div_{\scriptstyle\it Int}}{\variable[Int]{I2}}}}{{\variable[Int]{I2}}\terminal{=/=Int}{\constant[\#Int]{0}}}{}
\krule{
\reduce{{\variable[Int]{I1}}\terminal{\%}{\variable[Int]{I2}}}{{\variable[Int]{I1}}\mathrel{\%_{\scriptstyle\it Int}}{\variable[Int]{I2}}}}{{\variable[Int]{I2}}\terminal{=/=Int}{\constant[\#Int]{0}}}{}
\krule{
\reduce{\terminal{-}{\variable[Int]{I}}}{{\constant[\#Int]{0}}\mathrel{-_{\scriptstyle\it Int}}{\variable[Int]{I}}}}{}{}
\krule{
\reduce{{\variable[Int]{I1}}\terminal{<}{\variable[Int]{I2}}}{{\variable[Int]{I1}}\mathrel{<_{\scriptstyle\it Int}}{\variable[Int]{I2}}}}{}{}
\krule{
\reduce{{\variable[Int]{I1}}\terminal{<=}{\variable[Int]{I2}}}{{\variable[Int]{I1}}\mathrel{\leq_{\scriptstyle\it Int}}{\variable[Int]{I2}}}}{}{}
\krule{
\reduce{{\variable[Int]{I1}}\terminal{>}{\variable[Int]{I2}}}{{\variable[Int]{I1}}\mathrel{>_{\scriptstyle\it Int}}{\variable[Int]{I2}}}}{}{}
\krule{
\reduce{{\variable[Int]{I1}}\terminal{>=}{\variable[Int]{I2}}}{{\variable[Int]{I1}}\mathrel{\geq_{\scriptstyle\it Int}}{\variable[Int]{I2}}}}{}{}
\krule{
\reduce{{\variable[Val]{V1}}\terminal{==}{\variable[Val]{V2}}}{{\variable[Val]{V1}}\terminal{==K}{\variable[Val]{V2}}}}{}{}
\krule{
\reduce{{\variable[Val]{V1}}\terminal{!=}{\variable[Val]{V2}}}{{\variable[Val]{V1}}\terminal{=/=K}{\variable[Val]{V2}}}}{}{}
\krule{
\reduce{{\variable[Bool]{T1}}\terminal{and}{\variable[Bool]{T2}}}{{\variable[Bool]{T1}}\wedge_{\scriptstyle\it Bool}{\variable[Bool]{T2}}}}{}{}
\krule{
\reduce{{\variable[Bool]{T1}}\terminal{or}{\variable[Bool]{T2}}}{{\variable[Bool]{T1}}\vee_{\scriptstyle\it Bool}{\variable[Bool]{T2}}}}{}{}
\krule{
\reduce{\terminal{not}{\variable[Bool]{T}}}{\neg_{\scriptstyle\it Bool}{\variable[Bool]{T}}}}{}{}
\krule{
\reduce{\terminal{if}{\constant[\#Bool]{true}}\terminal{then}{\variable[K]{E}}\terminal{else}{\AnyVar[K]}}{\variable[K]{E}}}{}{}
\krule{
\reduce{\terminal{if}{\constant[\#Bool]{false}}\terminal{then}{\AnyVar[K]}\terminal{else}{\variable[K]{E}}}{\variable[K]{E}}}{}{}

\begin{syntaxBlock}{\nonTerminal{\sort{Val}}}\syntax{\textsf{closure}_\lambda({{\nonTerminal{\sort{Map}}}},{{\nonTerminal{\sort{Id}}}},{{\nonTerminal{\sort{Exp}}}})}{}
\end{syntaxBlock}
\krule{
\kprefix[green]{k}{\reduce{\lambda{\variable[Id]{X}}.{\variable[Exp]{E}}}{\textsf{closure}_\lambda({\variable[Map]{{\rho}}},{\variable[Id]{X}},{\variable[Exp]{E}})}}
\mathrel{}\kall[LightSkyBlue]{env}{\variable[Map]{{\rho}}}
}{}{}
\krule{
\kprefix[green]{k}{\reduce{{\textsf{closure}_\lambda({\variable[Map]{{\rho}}},{\variable[Id]{X}},{\variable[Exp]{E}})}\mathrel{}{\variable[Val]{V}}}{\variable[Exp]{E}\kra\terminal{env}({\variable[Map]{{\rho}'}})}}
\mathrel{}\kall[LightSkyBlue]{env}{\reduce{\variable[Map]{{\rho}'}}{{\variable[Map]{{\rho}}}[{\variable[K]{L}}\terminal{/}{\variable[Id]{X}}]}}
\mathrel{}\kmiddle[white]{store}{\reduce{\dotCt{Map}}{\variable[K]{L}\mapsto\variable[Val]{V}}}
\mathrel{}\kall[gray]{nextLoc}{\reduce{\variable[K]{L}}{{\variable[K]{L}}\mathrel{+_{\scriptstyle\it Int}}{\constant[\#Int]{1}}}}
}{}{}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{\terminal{env}({{\nonTerminal{\sort{Map}}}})}{}
\end{syntaxBlock}
\krule{
\kprefix[green]{k}{\variable[Val]{V}\kra\reduce{\terminal{env}({\variable[Map]{{\rho}}})}{\dotCt{K}}}
\mathrel{}\kall[LightSkyBlue]{env}{\reduce{\AnyVar[Map]}{\variable[Map]{{\rho}}}}
}{}{structural}
\krule{
\reduce{\terminal{env}({\AnyVar[Map]})}{\dotCt{K}}\kra\terminal{env}({\AnyVar[Map]})}{}{structural}

\begin{syntaxBlock}{\nonTerminal{\sort{Exp}}}\syntax{\textsf{closure}_\mu({{\nonTerminal{\sort{Map}}}},{{\nonTerminal{\sort{Exp}}}})}{}
\end{syntaxBlock}
\krule{
\kprefix[green]{k}{\reduce{\mu{\variable[Id]{X}}.{\variable[Exp]{E}}}{\textsf{closure}_\mu({{\variable[Map]{{\rho}}}[{\variable[Nat]{L}}\terminal{/}{\variable[Id]{X}}]},{\variable[Exp]{E}})}}
\mathrel{}\kall[LightSkyBlue]{env}{\variable[Map]{{\rho}}}
\mathrel{}\kmiddle[white]{store}{\reduce{\dotCt{Map}}{\variable[Nat]{L}\mapsto\textsf{closure}_\mu({{\variable[Map]{{\rho}}}[{\variable[Nat]{L}}\terminal{/}{\variable[Id]{X}}]},{\variable[Exp]{E}})}}
\mathrel{}\kall[gray]{nextLoc}{\reduce{\variable[Nat]{L}}{{\variable[Nat]{L}}\mathrel{+_{\scriptstyle\it Int}}{\constant[\#Int]{1}}}}
}{}{}
\krule{
\kprefix[green]{k}{\reduce{\textsf{closure}_\mu({\variable[Map]{{\rho}}},{\variable[Exp]{E}})}{\variable[Exp]{E}\kra\terminal{env}({\variable[Map]{{\rho}'}})}}
\mathrel{}\kall[LightSkyBlue]{env}{\reduce{\variable[Map]{{\rho}'}}{\variable[Map]{{\rho}}}}
}{}{}
\end{module}
\end{kdefinition}
\end{document}
