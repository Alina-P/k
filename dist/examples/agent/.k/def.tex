\nonstopmode
\documentclass{article}
\usepackage[poster,style=bubble]{k}
\title{AGENT}
\begin{document}
\begin{kdefinition}
\maketitle
\begin{module}{\moduleName{EXP-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{{\nonTerminal{\sort{Bool}}}}{}\syntaxCont{{\nonTerminal{\sort{Int}}}}{}\syntaxCont{({\nonTerminal{\sort{K}}})}{}\syntaxCont{{{\nonTerminal{\sort{K}}}}\terminal{*}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{K}}}}\terminal{/}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{K}}}}\terminal{+}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{K}}}}\leq{{\nonTerminal{\sort{K}}}}}{seqstrict}\syntaxCont{{{\nonTerminal{\sort{K}}}}\terminal{==}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{\terminal{not}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{K}}}}\terminal{and}{{\nonTerminal{\sort{K}}}}}{strict(1)}
\end{syntaxBlock}
\end{module}
\begin{module}{\moduleName{EXP}}

\begin{syntaxBlock}{\nonTerminal{\sort{KResult}}}\syntax{{\nonTerminal{\sort{Bool}}}}{}\syntaxCont{{\nonTerminal{\sort{Int}}}}{}
\end{syntaxBlock}
\krule{
\reduce{{\variable[Int]{I1}}\terminal{+}{\variable[Int]{I2}}}{{\variable[Int]{I1}}\mathrel{+_{\scriptstyle\it Int}}{\variable[Int]{I2}}}}{}{}
\krule{
\reduce{{\variable[Int]{I1}}\terminal{*}{\variable[Int]{I2}}}{{\variable[Int]{I1}}\mathrel{\ast_{\scriptstyle\it Int}}{\variable[Int]{I2}}}}{}{}
\krule{
\reduce{{\variable[Int]{I1}}\terminal{/}{\variable[Int]{I2}}}{{\variable[Int]{I1}}\mathrel{\div_{\scriptstyle\it Int}}{\variable[Int]{I2}}}}{{\variable[Int]{I2}}\terminal{=/=Int}{\constant[\#Int]{0}}}{}
\krule{
\reduce{{\variable[Int]{I1}}\leq{\variable[Int]{I2}}}{{\variable[Int]{I1}}\mathrel{\leq_{\scriptstyle\it Int}}{\variable[Int]{I2}}}}{}{}
\krule{
\reduce{{\variable[KResult]{V1}}\terminal{==}{\variable[KResult]{V2}}}{{\variable[KResult]{V1}}\terminal{==K}{\variable[KResult]{V2}}}}{}{}
\krule{
\reduce{\terminal{not}{\variable[Bool]{T}}}{\neg_{\scriptstyle\it Bool}{\variable[Bool]{T}}}}{}{}
\krule{
\reduce{{\constant[\#Bool]{true}}\terminal{and}{\variable[K]{E}}}{\variable[K]{E}}}{}{}
\krule{
\reduce{{\constant[\#Bool]{false}}\terminal{and}{\variable[K]{E}}}{\constant[\#Bool]{false}}}{}{}
\end{module}
\begin{module}{\moduleName{IF-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{{\nonTerminal{\sort{Bool}}}}{}\syntaxCont{\terminal{if}{{\nonTerminal{\sort{K}}}}\terminal{then}{{\nonTerminal{\sort{K}}}}\terminal{else}{{\nonTerminal{\sort{K}}}}}{strict(1)}
\end{syntaxBlock}
\end{module}
\begin{module}{\moduleName{IF}}

\begin{syntaxBlock}{\nonTerminal{\sort{KResult}}}\syntax{{\nonTerminal{\sort{Bool}}}}{}
\end{syntaxBlock}
\krule{
\reduce{\terminal{if}{\constant[\#Bool]{true}}\terminal{then}{\variable[K]{E}}\terminal{else}{\AnyVar[K]}}{\variable[K]{E}}}{}{}
\krule{
\reduce{\terminal{if}{\constant[\#Bool]{false}}\terminal{then}{\AnyVar[K]}\terminal{else}{\variable[K]{E}}}{\variable[K]{E}}}{}{}
\end{module}
\begin{module}{\moduleName{LAMBDA-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{{\nonTerminal{\sort{Id}}}}{}\syntaxCont{({\nonTerminal{\sort{K}}})}{}\syntaxCont{{{\nonTerminal{\sort{K}}}}\mathrel{}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{\lambda{{\nonTerminal{\sort{Id}}}}.{{\nonTerminal{\sort{K}}}}}{binder}
\end{syntaxBlock}
\end{module}
\begin{module}{\moduleName{LAMBDA}}

\begin{syntaxBlock}{\nonTerminal{\sort{KResult}}}\syntax{{\nonTerminal{\sort{Id}}}}{}\syntaxCont{\lambda{{\nonTerminal{\sort{Id}}}}.{{\nonTerminal{\sort{K}}}}}{binder}
\end{syntaxBlock}
\krule{
\reduce{{\lambda{\variable[Id]{X}}.{\variable[K]{E}}}\mathrel{}{\variable[KResult]{V}}}{{\variable[K]{E}}[{\variable[KResult]{V}}\terminal{/}{\variable[Id]{X}}]}}{}{}
\end{module}
\begin{module}{\moduleName{MU-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{\mu{{\nonTerminal{\sort{Id}}}}.{{\nonTerminal{\sort{K}}}}}{binder}
\end{syntaxBlock}
\end{module}
\begin{module}{\moduleName{MU}}
\krule{
\reduce{\mu{\variable[Id]{X}}.{\variable[K]{E}}}{{\variable[K]{E}}[{\mu{\variable[Id]{X}}.{\variable[K]{E}}}\terminal{/}{\variable[Id]{X}}]}}{}{}
\end{module}
\begin{module}{\moduleName{CALLCC-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{\terminal{callcc}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{{\it cc}({{\nonTerminal{\sort{K}}}})}{}
\end{syntaxBlock}
\end{module}
\begin{module}{\moduleName{CALLCC}}

\begin{syntaxBlock}{\nonTerminal{\sort{KResult}}}\syntax{{\it cc}({{\nonTerminal{\sort{K}}}})}{}
\end{syntaxBlock}
\krule[save-cxt]{
\kall{k}{\reduce{\terminal{callcc}{\variable[KResult]{V}}}{{\variable[KResult]{V}}\mathrel{}{{\it cc}({\variable[K]{K}})}}\kra\variable[K]{K}}
}{}{}
\krule[restore-cxt]{
\kall{k}{\reduce{{{\it cc}({\variable[K]{K}})}\mathrel{}{\variable[K]{V}}\kra\AnyVar[K]}{\variable[K]{V}\kra\variable[K]{K}}}
}{}{}
\end{module}
\begin{module}{\moduleName{HALT-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{\terminal{halt}{{\nonTerminal{\sort{K}}}}}{strict}
\end{syntaxBlock}
\end{module}
\begin{module}{\moduleName{HALT}}
\krule{
\kall{k}{\reduce{\terminal{halt}{\variable[KResult]{V}}\kra\AnyVar[K]}{\variable[KResult]{V}}}
}{}{}
\end{module}
\begin{module}{\moduleName{SEQ-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{\terminal{skip}}{}\syntaxCont{{{\nonTerminal{\sort{K}}}}\terminal{;}{{\nonTerminal{\sort{K}}}}}{strict(1)}
\end{syntaxBlock}
\end{module}
\begin{module}{\moduleName{SEQ}}

\begin{syntaxBlock}{\nonTerminal{\sort{KResult}}}\syntax{\terminal{skip}}{}
\end{syntaxBlock}
\krule{
\reduce{{\variable[KResult]{V}}\terminal{;}{\variable[K]{S}}}{\variable[K]{S}}}{}{structural}
\end{module}
\begin{module}{\moduleName{IO-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{{\nonTerminal{\sort{Int}}}}{}\syntaxCont{\terminal{read}}{}\syntaxCont{\terminal{print}{{\nonTerminal{\sort{K}}}}}{strict}
\end{syntaxBlock}
\end{module}
\begin{module}{\moduleName{IO}}
\kconfig{\kall{k}{\dotCt{K}}
\mathrel{}\kall{in}{\dotCt{List}}
\mathrel{}\kall{out}{\dotCt{List}}
}
\krule{
\kprefix{k}{\reduce{\terminal{read}}{\variable[Int]{I}}}
\mathrel{}\kprefix{in}{\reduce{\variable[Int]{I}}{\dotCt{List}}}
}{}{}
\krule{
\kprefix{k}{\reduce{\terminal{print}{\variable[KResult]{V}}}{\terminal{skip}}}
\mathrel{}\ksuffix{out}{\reduce{\dotCt{List}}{\variable[KResult]{V}}}
}{}{}
\end{module}
\begin{module}{\moduleName{REF-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{{\nonTerminal{\sort{Nat}}}}{}\syntaxCont{\terminal{ref}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{\terminal{*}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{{{\nonTerminal{\sort{K}}}}\terminal{:=}{{\nonTerminal{\sort{K}}}}}{strict(2)}
\end{syntaxBlock}
\end{module}
\begin{module}{\moduleName{REF}}
\kconfig{\kall{k}{\dotCt{K}}
\mathrel{}\kall{mem}{\dotCt{Map}}
\mathrel{}\kall{nextLoc}{\constant[\#Int]{0}}
}
\kcontext{
{\terminal{*}{\khole{}}}\terminal{:=}{\AnyVar[K]}}{}{}
\krule{
\kprefix{k}{\reduce{\terminal{ref}{\variable[KResult]{V}}}{\variable[Nat]{N}}}
\mathrel{}\kmiddle{mem}{\reduce{\dotCt{Map}}{\variable[Nat]{N}\mapsto\variable[KResult]{V}}}
\mathrel{}\kall{nextLoc}{\reduce{\variable[Nat]{N}}{{\variable[Nat]{N}}\mathrel{+_{\scriptstyle\it Int}}{\constant[\#Int]{1}}}}
}{}{}
\krule{
\kprefix{k}{\reduce{\terminal{*}{\variable[K]{N}}}{\variable[K]{V}}}
\mathrel{}\kmiddle{mem}{\variable[K]{N}\mapsto\variable[K]{V}}
}{}{transition}
\krule{
\kprefix{k}{\reduce{{\terminal{*}{\variable[K]{N}}}\terminal{:=}{\variable[K]{V}}}{\terminal{skip}}}
\mathrel{}\kmiddle{mem}{\variable[K]{N}\mapsto\reduce{\AnyVar[List\{K\}]}{\variable[K]{V}}}
}{}{transition}
\end{module}
\begin{module}{\moduleName{WHILE-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{\terminal{while}{{\nonTerminal{\sort{K}}}}\terminal{do}{{\nonTerminal{\sort{K}}}}}{}
\end{syntaxBlock}
\end{module}
\begin{module}{\moduleName{WHILE}}
\krule{
\reduce{\terminal{while}{\variable[K]{E}}\terminal{do}{\variable[K]{S}}}{\terminal{if}{\variable[K]{E}}\terminal{then}{{\variable[K]{S}}\terminal{;}{\terminal{while}{\variable[K]{E}}\terminal{do}{\variable[K]{S}}}}\terminal{else}{\terminal{skip}}}}{}{}
\end{module}
\begin{module}{\moduleName{THREADS-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{{\nonTerminal{\sort{Nat}}}}{}\syntaxCont{\terminal{acquire}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{\terminal{release}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{\terminal{rendezvous}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{\terminal{spawn}{{\nonTerminal{\sort{K}}}}}{}
\end{syntaxBlock}
\end{module}
\begin{module}{\moduleName{THREADS}}
\kconfig{\kall{thread}{\kall{k}{\dotCt{K}}
\mathrel{}\kall{holds}{\dotCt{Map}}
}
\mathrel{}\kall{busy}{\dotCt{Set}}
}
\krule[spawn-thread]{
\kmiddle{thread}{\kprefix{k}{\reduce{\terminal{spawn}{\variable[K]{S}}}{\terminal{skip}}}
}
\mathrel{}\reduce{\dotCt{Bag}}{\kmiddle{thread}{\kall{k}{\variable[K]{S}}
}
}}{}{transition}
\krule[end-thread]{
\reduce{\kmiddle{thread}{\kall{k}{\variable[KResult]{V}}
\mathrel{}\kall{holds}{\variable[Map]{Holds}}
}
}{\dotCt{Bag}}\mathrel{}\kall{busy}{\reduce{\variable[Set]{Busy}}{{\variable[Set]{Busy}}\terminal{-Set}{\terminal{keys}{\variable[Map]{Holds}}}}}
}{}{transition}
\krule[free-acquire]{
\kprefix{k}{\reduce{\terminal{acquire}{\variable[K]{V}}}{\terminal{skip}}}
\mathrel{}\kmiddle{holds}{\reduce{\dotCt{Map}}{\variable[K]{V}\mapsto\constant[\#Int]{0}}}
\mathrel{}\kall{busy}{\variable[Set]{Busy}\mathrel{}\reduce{\dotCt{Set}}{\variable[K]{V}}}
}{\neg_{\scriptstyle\it Bool}{{\variable[K]{V}}\terminal{in}{\variable[Set]{Busy}}}}{transition}
\krule[reentrant-acquire]{
\kprefix{k}{\reduce{\terminal{acquire}{\variable[K]{V}}}{\terminal{skip}}}
\mathrel{}\kmiddle{holds}{\variable[K]{V}\mapsto\reduce{\variable[Nat]{N}}{{\variable[Nat]{N}}\mathrel{+_{\scriptstyle\it Int}}{\constant[\#Int]{1}}}}
}{}{}
\krule[reentrant-release]{
\kprefix{k}{\reduce{\terminal{release}{\variable[K]{V}}}{\terminal{skip}}}
\mathrel{}\kmiddle{holds}{\variable[K]{V}\mapsto\reduce{\variable[K]{N}}{{\variable[K]{N}}\mathrel{-_{\scriptstyle\it Int}}{\constant[\#Int]{1}}}}
}{{\variable[K]{N}}\mathrel{>_{\scriptstyle\it Int}}{\constant[\#Int]{0}}}{}
\krule[release]{
\kprefix{k}{\reduce{\terminal{release}{\variable[K]{V}}}{\terminal{skip}}}
\mathrel{}\kmiddle{holds}{\reduce{\variable[K]{V}\mapsto\constant[\#Int]{0}}{\dotCt{Map}}}
\mathrel{}\kmiddle{busy}{\reduce{\variable[K]{V}}{\dotCt{Set}}}
}{}{}
\krule[rendezvous]{
\kprefix{k}{\reduce{\terminal{rendezvous}{\variable[K]{V}}}{\terminal{skip}}}
\mathrel{}\kprefix{k}{\reduce{\terminal{rendezvous}{\variable[K]{V}}}{\terminal{skip}}}
}{}{transition}
\end{module}
\begin{module}{\moduleName{AGENTS-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{{\nonTerminal{\sort{Int}}}}{}\syntaxCont{{\nonTerminal{\sort{Bool}}}}{}\syntaxCont{\terminal{newAgent}{{\nonTerminal{\sort{K}}}}}{}\syntaxCont{\terminal{me}}{}\syntaxCont{\terminal{parent}}{}\syntaxCont{\terminal{receive}}{}\syntaxCont{\terminal{receiveFrom}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{\terminal{send}{{\nonTerminal{\sort{K}}}}\terminal{to}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{\terminal{sendSynch}{{\nonTerminal{\sort{K}}}}\terminal{to}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{\terminal{barrier}}{}\syntaxCont{\terminal{broadcast}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{\terminal{haltAgent}}{}
\end{syntaxBlock}
\end{module}
\begin{module}{\moduleName{AGENTS}}
\kconfig{\kall{agent}{\kall{me}{\constant[\#Int]{0}}
\mathrel{}\kall{parent}{\constant[\#Int]{-1}}
\mathrel{}\kall{control}{\kall[green]{k}{\dotCt{K}}
}
}
\mathrel{}\kall{nextAgent}{\constant[\#Int]{1}}
\mathrel{}\kall{world}{\constant[\#Int]{0}}
\mathrel{}\kall{barrier}{\constant[\#Bool]{true}}
\mathrel{}\kall{waiting}{\dotCt{Set}}
\mathrel{}\kall{messages}{\kall{message}{\kall{from}{\dotCt{K}}
\mathrel{}\kall{to}{\dotCt{Set}}
\mathrel{}\kall{body}{\dotCt{K}}
}
}
}
\krule[agent-creation]{
\kmiddle{agent}{\kprefix[green]{k}{\reduce{\terminal{newAgent}{\variable[K]{S}}}{\variable[Nat]{N2}}}
\mathrel{}\kall{me}{\variable[Nat]{N1}}
}
\mathrel{}\kmiddle{world}{\reduce{\dotCt{Set}}{\variable[Nat]{N2}}}
\mathrel{}\reduce{\dotCt{Bag}}{\kmiddle{agent}{\kall{me}{\variable[Nat]{N2}}
\mathrel{}\kall{parent}{\variable[Nat]{N1}}
\mathrel{}\kall[green]{k}{\variable[K]{S}}
}
}\mathrel{}\kall{nextAgent}{\reduce{\variable[Nat]{N2}}{{\variable[Nat]{N2}}\mathrel{+_{\scriptstyle\it Int}}{\constant[\#Int]{1}}}}
}{}{}
\krule[agent-completion]{
\reduce{\kmiddle{agent}{\kall{control}{\dotCt{Bag}}
\mathrel{}\kall{me}{\variable[Nat]{N}}
}
}{\dotCt{Bag}}\mathrel{}\kmiddle{world}{\reduce{\variable[Nat]{N}}{\dotCt{Set}}}
}{}{}
\krule[halt-agent]{
\reduce{\kmiddle{control}{\kprefix[green]{k}{\terminal{haltAgent}}
}
}{\kall{control}{\dotCt{Bag}}
\mathrel{}\dotCt{Bag}}}{}{}
\krule{
\kprefix[green]{k}{\reduce{\terminal{me}}{\variable[K]{N}}}
\mathrel{}\kall{me}{\variable[K]{N}}
}{}{}
\krule{
\kprefix[green]{k}{\reduce{\terminal{parent}}{\variable[K]{N}}}
\mathrel{}\kall{parent}{\variable[K]{N}}
}{}{}
\krule{
\kall{me}{\variable[K]{N1}}
\mathrel{}\kprefix[green]{k}{\reduce{\terminal{send}{\variable[K]{V}}\terminal{to}{\variable[K]{N2}}}{\terminal{skip}}}
\mathrel{}\reduce{\dotCt{Bag}}{\kall{message}{\kall{from}{\variable[K]{N1}}
\mathrel{}\kall{to}{\variable[K]{N2}}
\mathrel{}\kall{body}{\variable[K]{V}}
}
}}{}{}
\krule{
\kall{me}{\variable[K]{N}}
\mathrel{}\kprefix[green]{k}{\reduce{\terminal{receive}}{\variable[KResult]{V}}}
\mathrel{}\kmiddle{message}{\kmiddle{to}{\reduce{\variable[K]{N}}{\dotCt{Set}}}
\mathrel{}\kall{body}{\variable[KResult]{V}}
}
}{}{}
\krule{
\kall{message}{\kall{from}{\variable[K]{N2}}
\mathrel{}\kmiddle{to}{\reduce{\variable[K]{N1}}{\dotCt{Set}}}
\mathrel{}\kall{body}{\variable[K]{V}}
}
\mathrel{}\kall{me}{\variable[K]{N1}}
\mathrel{}\kprefix[green]{k}{\reduce{\terminal{receiveFrom}{\variable[K]{N2}}}{\variable[K]{V}}}
}{}{}
\krule{
\kall{me}{\variable[K]{N}}
\mathrel{}\kprefix[green]{k}{\reduce{\terminal{broadcast}{\variable[K]{V}}}{\terminal{skip}}}
\mathrel{}\kall{world}{\variable[Set]{W}}
\mathrel{}\reduce{\dotCt{Bag}}{\kall{message}{\kall{from}{\variable[K]{N}}
\mathrel{}\kall{to}{\variable[Set]{W}}
\mathrel{}\kall{body}{\variable[K]{V}}
}
}}{}{}
\krule{
\reduce{\kmiddle{message}{\kall{to}{\dotCt{Set}}
}
}{\dotCt{Bag}}}{}{structural}
\krule{
\kmiddle{agent}{\kall{me}{\variable[K]{N1}}
\mathrel{}\kprefix[green]{k}{\reduce{\terminal{sendSynch}{\variable[K]{V}}\terminal{to}{\variable[K]{N2}}}{\terminal{skip}}}
}
\mathrel{}\kmiddle{agent}{\kall{me}{\variable[K]{N2}}
\mathrel{}\kprefix[green]{k}{\reduce{\terminal{receiveFrom}{\variable[K]{N1}}}{\variable[K]{V}}}
}
}{}{}
\krule{
\kprefix[green]{k}{\reduce{\terminal{sendSynch}{\variable[K]{V}}\terminal{to}{\variable[K]{N2}}}{\terminal{skip}}}
\mathrel{}\kmiddle{agent}{\kall{me}{\variable[K]{N2}}
\mathrel{}\kprefix[green]{k}{\reduce{\terminal{receive}}{\variable[K]{V}}}
}
}{}{}
\krule[start-waiting-at-barrier]{
\kall{me}{\variable[K]{N}}
\mathrel{}\kprefix[green]{k}{\terminal{barrier}}
\mathrel{}\kall{barrier}{\constant[\#Bool]{true}}
\mathrel{}\kall{waiting}{\variable[Set]{W}\mathrel{}\reduce{\dotCt{Set}}{\variable[K]{N}}}
}{\neg_{\scriptstyle\it Bool}{{\variable[K]{N}}\terminal{in}{\variable[Set]{W}}}}{}
\krule[lifting-barrier]{
\kall{barrier}{\reduce{\constant[\#Bool]{true}}{\constant[\#Bool]{false}}}
\mathrel{}\kall{waiting}{\variable[Set]{W}}
\mathrel{}\kall{world}{\variable[Set]{W}}
}{{\variable[Set]{W}}\terminal{=/=Set}{\dotCt{Set}}}{}
\krule[leave-barrier]{
\kall{me}{\variable[K]{N}}
\mathrel{}\kprefix[green]{k}{\reduce{\terminal{barrier}}{\terminal{skip}}}
\mathrel{}\kall{barrier}{\constant[\#Bool]{false}}
\mathrel{}\kmiddle{waiting}{\reduce{\variable[K]{N}}{\dotCt{Set}}}
}{}{}
\krule[lowering-barrier]{
\kall{barrier}{\reduce{\constant[\#Bool]{false}}{\constant[\#Bool]{true}}}
\mathrel{}\kall{waiting}{\dotCt{Set}}
}{}{}
\end{module}
\begin{module}{\moduleName{QUOTE-UNQUOTE-SYNTAX}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{\terminal{quote}{{\nonTerminal{\sort{K}}}}}{}\syntaxCont{\terminal{unquote}{{\nonTerminal{\sort{K}}}}}{}\syntaxCont{\terminal{lift}{{\nonTerminal{\sort{K}}}}}{strict}\syntaxCont{\terminal{eval}{{\nonTerminal{\sort{K}}}}}{strict}
\end{syntaxBlock}
\end{module}
\begin{module}{\moduleName{QUOTE-UNQUOTE}}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{\terminal{isQuote}({{\nonTerminal{\sort{K}}}})}{klabel(isQuote)}
\end{syntaxBlock}
\krule{
\reduce{\terminal{isQuote}({\terminal{quote}{\variable[K]{K}}})}{\constant[\#Bool]{true}}}{}{anywhere}
\krule{
\reduce{\terminal{isQuote}({\terminal{unquote}{\variable[K]{K}}})}{\constant[\#Bool]{true}}}{}{anywhere}

\begin{syntaxBlock}{\nonTerminal{\sort{K}}}\syntax{{\it quote}({{\nonTerminal{\sort{K}}}},{{\nonTerminal{\sort{Nat}}}})}{klabel(mQuote)}
\end{syntaxBlock}
\krule{
\reduce{{\it quote}({\variable[K]{K}},{\variable[K]{N}})}{\mbox{apply }{{\it quote}_{\mbox{\scriptsize\ensuremath{\variable[K]{N}}}}}\mbox{ in }{\variable[K]{K}}\mbox{ if }{\constant[KLabel]{'isQuote}}}}{}{structural, anywhere}

\begin{syntaxBlock}{\nonTerminal{\sort{KLabel}}}\syntax{{\it quote}_{\mbox{\scriptsize\ensuremath{{\nonTerminal{\sort{Nat}}}}}}}{}
\end{syntaxBlock}
\krule{
\kprefix[green]{k}{\reduce{\terminal{quote}{\variable[K]{K}}}{{\it quote}({\variable[K]{K}},{\constant[\#Int]{0}})}}
}{}{}
\krule{
\reduce{{\it quote}_{\mbox{\scriptsize\ensuremath{\variable[K]{N}}}}(\terminal{quote}{\variable[K]{K}})}{\framebox{\constant[KLabel]{'quote\_}}({\it quote}({\variable[K]{K}},{{\variable[K]{N}}\mathrel{+_{\scriptstyle\it Int}}{\constant[\#Int]{1}}}))}}{}{}
\krule{
\reduce{{\it quote}_{\mbox{\scriptsize\ensuremath{\constant[\#Int]{0}}}}(\terminal{unquote}{\variable[K]{K}})}{\variable[K]{K}}}{}{}
\krule{
\reduce{{\it quote}_{\mbox{\scriptsize\ensuremath{\variable[Nat]{N}}}}(\terminal{unquote}{\variable[K]{K}})}{\framebox{\constant[KLabel]{'unquote\_}}({\it quote}({\variable[K]{K}},{{\variable[Nat]{N}}\mathrel{-_{\scriptstyle\it Int}}{\constant[\#Int]{1}}}))}}{{\variable[Nat]{N}}\mathrel{>_{\scriptstyle\it Int}}{\constant[\#Int]{0}}}{}
\krule{
\reduce{\terminal{lift}{\variable[KResult]{V}}}{\framebox{${\variable[KResult]{V}}$}}}{}{}
\krule{
\reduce{\terminal{eval}{\framebox{${\variable[List\{K\}]{K}}$}}}{\variable[List\{K\}]{K}}}{}{}
\end{module}
\begin{module}{\moduleName{AGENT-SYNTAX}}
\end{module}
\begin{module}{\moduleName{AGENT}}
\kconfig{\kall{T}{\kall{agent}{\kall{control}{\kall{thread}{\kall[green]{k}{\variable[K]{\$PGM}}
\mathrel{}\kall{holds}{\dotCt{Map}}
}
}
\mathrel{}\kall{busy}{\dotCt{Set}}
\mathrel{}\kall{mem}{\dotCt{Map}}
\mathrel{}\kall{nextLoc}{\constant[\#Int]{0}}
\mathrel{}\kall{me}{\constant[\#Int]{0}}
\mathrel{}\kall{parent}{\constant[\#Int]{-1}}
}
\mathrel{}\kall{nextAgent}{\constant[\#Int]{1}}
\mathrel{}\kall{world}{\constant[\#Int]{0}}
\mathrel{}\kall{barrier}{\constant[\#Bool]{true}}
\mathrel{}\kall{waiting}{\dotCt{Set}}
\mathrel{}\kall{messages}{\kall{message}{\kall{from}{\dotCt{K}}
\mathrel{}\kall{to}{\dotCt{Set}}
\mathrel{}\kall{body}{\dotCt{K}}
}
}
\mathrel{}\kall{IO}{\kall{in}{\dotCt{List}}
\mathrel{}\kall{out}{\dotCt{List}}
}
}
}

\begin{syntaxBlock}{\nonTerminal{\sort{KResult}}}\syntax{{\nonTerminal{\sort{Id}}}}{}
\end{syntaxBlock}
\end{module}
\end{kdefinition}
\end{document}
